// test accessing LIF file. 
// wrote for checking the loci_tools.jar
// open an arbiturary plane and closes. 
// 20101122 Kota Miura

	srcfile = getArgument();		//cui
	//srcfile = File.openDialog("Select a LIF File"); //gui
	id = srcfile;  
	name = File.getName(id); 
	seriesNum = 1;
	ch = 0;
	print(id);
	run("Bio-Formats Macro Extensions");
	//Ext.fileGroupOption(id, fileGroupOption);
	//print(fileGroupOption);

	Ext.setGroupFiles("false");

	Ext.getVersionNumber(version);
	Ext.getRevision(revision);
	Ext.getBuildDate(date);
	print("Loci_Tools.jar Version: " + version);
	print("revision: " + revision);
	print("date: " + date);

	Ext.setId(id);
	Ext.setSeries(seriesNum);
	Ext.getSeriesName(seriesName); print(seriesName);
	Ext.getSizeZ(sizeZ);
	Ext.getSizeC(sizeC);
	Ext.getSizeT(sizeT);
	Ext.getDimensionOrder(dimOrder); 	print(dimOrder);
	Ext.getImageCount(imageCount);
	Ext.getPixelsPhysicalSizeX(psizeX);
	Ext.getPixelsPhysicalSizeY(psizeY);
	Ext.getPixelsPhysicalSizeZ(psizeZ);
  
	print("ImageCount:"+imageCount);

	calculatedCount = sizeZ*sizeC*sizeT;
	print("...calculated"+calculatedCount);
	sizeT = imageCount/sizeC/sizeZ;
	print("C:"+sizeC+" Z:"+sizeZ+" T:"+sizeT);
	newname = name+"_"+seriesNum+"_ch"+ch+".tif";

  print("Pysical Size: xy = "+ psizeX + " z = " + psizeZ); 
	//Ext.isGroupFiles(group);
	//print("group plociy:" + group);

	
	i = 3;
	j = 0;
	currentPlane = j*sizeZ*sizeC + i*sizeC;
	Ext.getIndex(i, ch, j, ttcurrentPlane);
  print ("plane index estimated by EXT:" + ttcurrentPlane);
	if (currentPlane < imageCount) {
		Ext.openImage("t"+j+"_z"+i, currentPlane+ch);
		getVoxelSize(width, height, depth, unit);
		print("Voxel XY size: " + width);
		print("Voxel Z size: " + depth);
		print("scale unit: " + unit);		
		print("t"+j+"_z"+i + "---"+ currentPlane+ch);
		close();
	} else print("assigned plane number exceeds the last plane");
